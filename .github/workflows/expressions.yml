
name: expressions CI
on: push

env:
  MY_BOOLEAN: ${{ true }}
  MY_NULL:    ${{ null }}
  MY_NUMBER:  ${{ 0xff }}
  MY_STRING:  ${{ 'Hello!' }}

jobs:
  expressions:
    strategy:
      matrix:
        os: [ubuntu-latest, macos-latest]
        greeting: [Hello, Howdy]

    # Use the matrix value so the 'matrix' context is available to the job
    runs-on: ${{ matrix.os }}

    # Use real '&&' (not HTML-escaped), and ensure branch name is correct
    if: ${{ github.ref == 'refs/heads/main' && contains(matrix.os, 'ubuntu') }}

    steps:
      - name: Show matrix values
        run: |
          echo "OS=${{ matrix.os }}"
          echo "Greeting=${{ matrix.greeting }}"

      - name: Format greeting
        run: echo "${{ format('{0}, {1}!', github.actor, matrix.greeting) }}"

      - name: Convert current job to JSON
        run: echo "${{ toJSON(job) }}"    # 'jobs' is only for reusable workflows

      - name: Parse JSON into env
        env: ${{ fromJSON('{"FOO":"bar"}') }}
        run: echo "$FOO"

      - name: All good (runs if previous steps succeeded)
        if: ${{ success() }}
        run: echo "All good"

      - name: Always runs
        if: ${{ always() }}
        run: echo "This always runs"
